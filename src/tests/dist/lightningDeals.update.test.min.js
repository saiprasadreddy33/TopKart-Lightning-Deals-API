"use strict";var request=require("supertest"),app=require("../../app"),_require=require("../../utils/tokenUtils"),generateToken=_require.generateToken,lightningDealModel=require("../../models/lightningDealModel"),authMiddleware=require("../../middleware/authMiddleware");describe("PUT /lightning-deals/:id",function(){var n,r,a;beforeAll(function(){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(generateToken({userId:"testuser"}));case 2:return n=e.sent,r={title:"Test Lightning Deal",description:"This is a test lightning deal",discountPercentage:30,startTime:new Date,endTime:new Date((new Date).getTime()+864e5)},e.next=6,regeneratorRuntime.awrap(lightningDealModel.create(r));case 6:t=e.sent,a=t._id.toString();case 8:case"end":return e.stop()}})}),afterAll(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(lightningDealModel.deleteOne({_id:a}));case 2:case"end":return e.stop()}})}),it("should return 401 unauthorized if user is not authenticated",function(){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(request(app).put("/lightning-deals/".concat(a)).send({title:"Updated Title"}));case 2:t=e.sent,expect(t.statusCode).toBe(401);case 4:case"end":return e.stop()}})}),it("should return 404 not found if lightning deal does not exist",function(){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(request(app).put("/lightning-deals/nonexistent-id").set("Authorization","Bearer ".concat(n)).send({title:"Updated Title"}));case 2:t=e.sent,expect(t.statusCode).toBe(404);case 4:case"end":return e.stop()}})}),it("should return 403 forbidden if user is not authorized to update lightning deal",function(){var t,n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return"otheruser",e.next=3,regeneratorRuntime.awrap(generateToken({userId:"otheruser"}));case 3:return t=e.sent,e.next=6,regeneratorRuntime.awrap(request(app).put("/lightning-deals/".concat(a)).set("Authorization","Bearer ".concat(t)).send({title:"Updated Title"}));case 6:n=e.sent,expect(n.statusCode).toBe(403);case 8:case"end":return e.stop()}})}),it("should update lightning deal and return 200 ok if user is authorized to update lightning deal",function(){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(request(app).put("/lightning-deals/".concat(a)).set("Authorization","Bearer ".concat(n)).send({title:"Updated Title"}));case 2:t=e.sent,expect(t.statusCode).toBe(200),expect(t.body.title).toBe("Updated Title");case 5:case"end":return e.stop()}})})});
//# sourceMappingURL=lightningDeals.update.test.min.js.map
